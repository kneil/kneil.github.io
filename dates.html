<script>

function getWeekNumber(d) {
    // Copy date so don't modify original
    d = new Date(Date.UTC(d.getFullYear(), d.getMonth(), d.getDate()));
    // Set to nearest Thursday: current date + 4 - current day number
    // Make Sunday's day number 7
    d.setUTCDate(d.getUTCDate() + 4 - (d.getUTCDay()||7));
    // Get first day of year
    var yearStart = new Date(Date.UTC(d.getUTCFullYear(),0,1));
    // Calculate full weeks to nearest Thursday
    var weekNo = Math.ceil(( ( (d - yearStart) / 86400000) + 1)/7);
    // Return array of year and week number
    return weekNo;
}

var WeekResult = getWeekNumber(new Date());
//var WeekResult = getWeekNumber(new Date("August 21, 2017 12:00:00"));

WiBTurn = new Array;

WiBTurn = ["Edward", "Beatrice", "Christina"];

ComTurn = new Array;

ComTurn = ["Edward", "Beatrice"];

Date.prototype.dayOfYear= function(){
    var j1= new Date(this);
    j1.setMonth(0, 0);
    return Math.round((this-j1)/8.64e7);
}

TheDateOfTheYear = new Date().dayOfYear();

Turn = TheDateOfTheYear % 3;
BookTurn = TheDateOfTheYear % 2;

ComTurnWeek = (  WeekResult + 1  )  % 2;

document.write (   ' What' + "'" + 's in the box: ' +  WiBTurn[Turn]  + '<br><br>                         Communion: ' + ComTurn[ComTurnWeek]         + '<br><br>                         Book turn: ' + ComTurn[BookTurn]   ) ;
</script>
